---
// SidebarSection.astro
// Removed AstroComponentFactory import due to linter error

interface Item {
  name: string;
}

interface Props {
  items: Item[];
  sectionTitle: string;
  listId: string;
  getColor: (name: string) => string;
  getInitials?: (name: string) => string;
  getIndicatorColors?: (color: string) => { indicator: string, gradient: string };
  selectedName?: string | null;
  linkPrefix: string;
  emptyText?: string;
}

const {
  items,
  sectionTitle,
  listId,
  getColor,
  getIndicatorColors,
  selectedName,
  linkPrefix,
  emptyText = 'No items.',
} = Astro.props;
---
<section class="mb-4">
  <h2 class="sidebar-section-title flex items-center gap-2 px-4 py-2 text-xs font-semibold uppercase tracking-wider text-gray-500 dark:text-zinc-400 bg-gray-50 dark:bg-zinc-900 border-b border-gray-200 dark:border-zinc-700">
    <slot name="icon" />
    {sectionTitle}
  </h2>
  {items.length > 0 ? (
    <ul id={listId} class="list-none p-0 m-0 relative divide-y divide-gray-100 dark:divide-zinc-700 bg-white dark:bg-zinc-800">
      {items.map((item: Item) => {
        const color = getColor(item.name);
        const bg = color.split(' ')[0];
        const text = color.split(' ')[1];
        const indicatorColors = getIndicatorColors ? getIndicatorColors(color) : null;
        const isSelected = selectedName && selectedName === item.name;
        return (
          <li class={isSelected ? 'relative group' : ''} data-name={item.name}>
            {isSelected && indicatorColors && (
              <div 
                id="api-indicator"
                class={`absolute left-0 w-1 rounded-r transition-all duration-300 ease-in-out z-0 ${indicatorColors.indicator}`} 
                style="opacity: 0;"
              />
            )}
            <a
              href={`/${linkPrefix}/${item.name.toLowerCase()}`}
              data-url={item.name}
              data-color={bg}
              class={`block w-full text-left py-3 px-4 border-l-4 text-sm transition-all duration-300 ease-in-out focus:outline-none relative overflow-hidden group cursor-pointer
                ${isSelected
                  ? 'border-l-transparent bg-zinc-200 text-zinc-900 font-medium dark:bg-zinc-700 dark:text-zinc-100 translate-x-0.5 api-selected'
                  : 'border-l-transparent text-gray-600 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-400 dark:hover:text-zinc-900'}`}
            >
              <div class="flex justify-center md:justify-start items-center gap-2">
                <span class={`inline-flex items-center justify-center h-6 w-6 rounded-full ${bg} ${text} mr-2`}>
                  <slot name="icon" />
                </span>
                <span class={`inline-flex items-center relative z-10 transition-transform duration-300 ${isSelected ? 'translate-x-1' : ''}`}>{item.name}</span>
              </div>
              {isSelected && indicatorColors && (
                <span class={`absolute inset-0 bg-gradient-to-r ${indicatorColors.gradient} to-transparent transition-all duration-500 opacity-100`} />
              )}
            </a>
          </li>
        );
      })}
    </ul>
  ) : (
    <p class="text-gray-500 dark:text-zinc-400 p-2 text-center md:text-sm">{emptyText}</p>
  )}
</section> 